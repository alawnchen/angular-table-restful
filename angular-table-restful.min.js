/*
 angular-table-restful v1.0.0
 https://github.com/mateusmcg/angular-table-restful
*/

(function(){var a,b,c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h='<tr ng-show="isEmpty()"><td colspan="100%"><strong class="text-warning"><i18n>Nenhum item encontrado.</i18n></strong></td></tr>',j="<div style='margin: 0px;'><ul class='pagination'><li ng-class='{disabled: getCurrentPage() <= 0}'><a href='' ng-click='firstPage()'>&lsaquo;</a></li><li ng-if='pageSequence.data[0] > 0'><a href='' ng-click='stepPage(-atConfig.numberOfPages)'>1</a></li><li ng-if='pageSequence.data[0] > 0'><a href='' ng-click='goToPage(getCurrentPage() + 1 <= 10 ? 0 : getCurrentPage() - 10)'>&hellip;</a></li><li ng-class='{active: getCurrentPage() == page}' ng-repeat='page in pageSequence.data'><a href='' ng-click='goToPage(page)'>{{page + 1}}</a></li><li ng-if='pageSequence.data[pageSequence.data.length -1] < getNumberOfPages() - 1'><a href='' ng-click='goToPage(getCurrentPage() + 1 + 10 > getNumberOfPages() ? getNumberOfPages() - 1 : atConfig.currentPage + 10)'>&hellip;</a></li><li ng-if='pageSequence.data[pageSequence.data.length -1] < getNumberOfPages() - 1'><a href='' ng-click='stepPage(getNumberOfPages())'>{{getNumberOfPages()}}</a></li><li ng-class='{disabled: getCurrentPage() >= getNumberOfPages() - 1}'><a href='' ng-click='stepPage(1)'>&rsaquo;</a></li></ul></div>",i="<tr ng-show='isInitialized() && !isEmpty() && getNumberOfPages() > 1' class='at-pagination'><td colspan='100%'>"+j+"</td></tr>",angular.module("angular-table",[]),a=function(){function a(a,b){this.attribute=a.attribute,this.title=a.title,this.sortable=a.sortable,this.width=a.width,this.initialSorting=a.initialSorting,b&&(this.customContent=b.customContent,this.attributes=b.attributes)}return a.prototype.createElement=function(){var a;return a=angular.element(document.createElement("th"))},a.prototype.renderTitle=function(a){return a.html(this.customContent||this.title)},a.prototype.renderAttributes=function(a){var b,c,d,e,f;if(this.attributes){for(e=this.attributes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(a.attr(b.name,b.value));return f}},a.prototype.renderSorting=function(a){var b;return this.sortable?(a.attr("ng-click","sort('"+this.attribute+"')"),b=angular.element("<i style='margin-left: 10px;'></i>"),b.attr("ng-class","getSortIcon('"+this.attribute+"')"),a.append(b)):void 0},a.prototype.renderWidth=function(a){return a.attr("width",this.width)},a.prototype.renderHtml=function(){var a;return a=this.createElement(),this.renderTitle(a),this.renderAttributes(a),this.renderSorting(a),this.renderWidth(a),a},a}(),d=function(){function a(a,b,c,d,e,f,g){angular.isDefined(d)&&(d=""==d.trim()?g.appContext&&g.appContext.defaultPageSize?g.appContext.defaultPageSize:10:parseInt(d)),this.scope=a,this.$q=f,a.atConfig=this.atConfig={itemsPerPage:d,currentPage:0,sortContext:"global",orderBy:"orderBy",changeEvent:c?this.scope.$eval(c):void 0,listName:b,sortList:[],predicates:[],numberOfPages:1,numberOfPagesToShow:5,getLastPage:function(){return a.sortedAndPaginatedList.totalCount%d==0?this.numberOfPages+1:this.numberOfPages},setSortAndPredicates:function(a,b){this.sortList=a?a:[],this.predicates=b?b:[]}},e&&a.$parent.$eval(e+"=value",{value:this.atConfig})}return a.prototype.getList=function(){return this.scope.$eval(this.atConfig.listName)},a.prototype.getTotalCount=function(){var a=this.getList();return a?this.atConfig.changeEvent?a.totalCount:a.length:void 0},a.prototype.setList=function(a){this.scope.$eval(this.atConfig.listName+"=list",{list:a})},a.prototype.getSortList=function(){return this.atConfig.sortList},a.prototype.setSortList=function(a){return this.atConfig.sortList=a},a.prototype.setPredicates=function(a){return this.atConfig.predicates=a},a.prototype.getPredicates=function(){return this.atConfig.predicates},a.prototype.callChangeEvent=function(a,b,c,d){var e=this.$q.defer();e.promise.then(function(b){b&&!b.pageNo&&(b.pageNo=a+1),d(b)}),this.atConfig.changeEvent({pageNo:a+1,pageSize:b,sort:c},e)},a.prototype.getItemsPerPage=function(){return this.atConfig.itemsPerPage},a.prototype.getCurrentPage=function(){return this.atConfig.currentPage},a.prototype.getSortContext=function(){return this.atConfig.sortContext},a.prototype.setCurrentPage=function(a){return this.atConfig.currentPage=a},a.prototype.getOrderBy=function(){return this.atConfig.orderBy},a.prototype.getOrderBy=function(){return this.atConfig.orderBy},a.prototype.getNumberOfPages=function(){return this.atConfig.numberOfPages},a.prototype.setNumberOfPages=function(a){return this.atConfig.numberOfPages=a},a.prototype.getNumberOfPagesToShow=function(){return this.atConfig.numberOfPagesToShow},a.prototype.keepItemSelected=function(){var a=this.atConfig?this.atConfig.selectedItem:void 0;a&&(angular.forEach(this.getList(),function(b,c){b.id&&a.id&&b.id==a.id&&(a=b)}),this.atConfig.selectedItem=a)},a}(),g=function(){function b(a,b){this.tableElement=a,this.attributes=b,this.id=this.attributes.id,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atTable,this.atChange=this.attributes.atChange,this.createColumnConfigurations()}return b.prototype.capitaliseFirstLetter=function(a){return a?a.charAt(0).toUpperCase()+a.slice(1):""},b.prototype.extractWidth=function(a){var b;return b=/([0-9]+px)/i.exec(a),b?b[0]:""},b.prototype.isSortable=function(a){var b;return b=/(sortable)/i.exec(a),b?!0:!1},b.prototype.getInitialSorting=function(a){var b;if(b=a.attr("at-initial-sorting")){if("asc"===b||"desc"===b)return b;throw"Invalid value for initial-sorting: "+b+". Allowed values are 'asc' or 'desc'."}return void 0},b.prototype.collectHeaderMarkup=function(a){var b,c,d,e,f,g;for(b={},d=a.find("tr"),g=d.find("th"),e=0,f=g.length;f>e;e++)c=g[e],c=angular.element(c),b[c.attr("at-attribute")]={customContent:c.html(),attributes:c[0].attributes};return b},b.prototype.collectBodyMarkup=function(a){var b,c,d,e,f,g,h,i,j,k;for(c=[],k=a.find("td"),i=0,j=k.length;j>i;i++)f=k[i],f=angular.element(f),b=f.attr("at-attribute"),g=f.attr("at-title")||this.capitaliseFirstLetter(f.attr("at-attribute")),e=void 0!==f.attr("at-sortable")||this.isSortable(f.attr("class")),h=this.extractWidth(f.attr("class")),d=this.getInitialSorting(f),c.push({attribute:b,title:g,sortable:e,width:h,initialSorting:d});return c},b.prototype.createColumnConfigurations=function(){var b,c,d,e,f;for(c=this.collectHeaderMarkup(this.tableElement),b=this.collectBodyMarkup(this.tableElement),this.columnConfigurations=[],e=0,f=b.length;f>e;e++)d=b[e],this.columnConfigurations.push(new a(d,c[d.attribute]))},b}(),e=function(){function a(){}return a.prototype.setupTr=function(a,b){var c,d;return c=a.find("tbody"),d=c.find("tr"),d.attr("ng-repeat",b),c},a}(),c=function(a){function c(){}return l(c,a),c.prototype.compile=function(a){var b=""|a.attr("track-by");b&&""!=b.trim()?(b.trim().indexOf("$")<0&&b.trim().indexOf("item.")<0&&(b="item."+b),this.setupTr(a,"item in sortedAndPaginatedList track by "+b)):this.setupTr(a,"item in sortedAndPaginatedList")},c.prototype.link=function(a,c,e,f,g,h){var i,j,k;k=new d(a,e.atTable,e.atChange,e.atPaginated,e.atConfig,g,h),i=function(a,b,c,d,e,f,g){var h,i;return a?(i=a,c&&(h=c*b-a.length),"global"===e?(f.length>0&&(i=g(d)(i,f)),c&&(i=g("limitTo")(i,h),i=g("limitTo")(i,c))):(c&&(i=g("limitTo")(i,h),i=g("limitTo")(i,c)),f.length>0&&(i=g(d)(i,f))),i):[]},keepInBounds=function(a,b,c){return a=Math.max(b,a),Math.min(c,a)},j=function(){if(k.getList()?e.atChange?a.sortedAndPaginatedList=k.getList():a.sortedAndPaginatedList=i(k.getList(),k.getCurrentPage(),k.getItemsPerPage(),k.getOrderBy(),k.getSortContext(),k.getPredicates(),f):a.sortedAndPaginatedList=null,k.getItemsPerPage()){var b,c,d;return d=k.getTotalCount(),d>0?(b=Math.ceil(d/k.getItemsPerPage()),c=b>=k.getNumberOfPagesToShow()?k.getNumberOfPagesToShow():b,k.setNumberOfPages(b),a.pageSequence.resetParameters(0,b,c),k.setCurrentPage(keepInBounds(k.getCurrentPage(),0,k.getNumberOfPages()-1)),a.pageSequence.realignGreedy(k.getCurrentPage())):(k.setNumberOfPages(1),a.pageSequence.resetParameters(0,1,1),k.setCurrentPage(0),a.pageSequence.realignGreedy(0))}},a.isInitialized=function(){return!angular.isUndefined(k.getList())&&!angular.isUndefined(k.getTotalCount())},a.isEmpty=function(){return a.isInitialized()&&k.getTotalCount()<1},a.getNumberOfPages=function(){return k.getNumberOfPages()},a.getCurrentPage=function(){return k.getCurrentPage()},a.sort=function(a){if(k.getSortList()){var b=[];b=b.concat(k.getSortList());var c=_.find(b,function(b){return b.predicate==a});if(c)if(c.descending)c.descending=!1;else{var d=b.indexOf(c);b.splice(d,1)}else b.push({predicate:a,descending:!0});var f=[];angular.forEach(b,function(a){a.descending?f.push("-"+a.predicate):f.push(a.predicate)}),e.atChange?(0!=k.getCurrentPage()&&k.setCurrentPage(0),k.callChangeEvent(k.getCurrentPage(),k.getItemsPerPage(),f,function(a){k.setSortList(b),k.setPredicates(f),k.setList(a),k.keepItemSelected()})):(k.setSortList(b),k.setPredicates(f),0!=k.getCurrentPage()?k.setCurrentPage(0):j())}},a.stepPage=function(b){b=parseInt(b),b=keepInBounds(k.getCurrentPage()+b,0,k.getNumberOfPages()-1),e.atChange?k.callChangeEvent(b,k.getItemsPerPage(),k.getPredicates(),function(c){a.pageSequence.realignGreedy(b),k.setCurrentPage(b),k.setList(c),k.keepItemSelected()}):(a.pageSequence.realignGreedy(b),k.setCurrentPage(b))},a.firstPage=function(){return a.stepPage(-1)},a.goToPage=function(a){return e.atChange?void k.callChangeEvent(a,k.getItemsPerPage(),k.getPredicates(),function(b){k.setCurrentPage(a),k.setList(b),k.keepItemSelected()}):k.setCurrentPage(a)},a.pageSequence=new b,e.atChange||a.$watch("atConfig.currentPage",function(a,b){return a!=b?j():void 0}),a.$watch("atConfig.itemsPerPage",function(a,b){if(a!=b){if(!e.atChange)return j();k.callChangeEvent(k.getCurrentPage(),a,k.getPredicates(),function(b){k.setItemsPerPage(a),k.setList(b),k.keepItemSelected()})}}),e.atChange||a.$watch("atConfig.sortContext",function(a,b){return a!=b?j():void 0}),a.$watchCollection(e.atTable,function(a,b){return a!=b?(e.atChange&&k.setCurrentPage(a&&a.pageNo?a.pageNo-1:0),j()):void 0}),j(),angular.isDefined(e.atLoad)&&e.atChange&&setTimeout(function(){k.callChangeEvent(0,k.getItemsPerPage(),void 0,function(a){k.setList(a),k.keepItemSelected()})},1)},c}(e),f=function(){function a(a,b){this.element=a,this.tableConfiguration=b}return a.prototype.constructHeader=function(){var a,b,c,d,e;for(b=this.element.find("thead > tr"),0==b.length&&(b=angular.element(document.createElement("tr"))),e=this.tableConfiguration.columnConfigurations,c=0,d=e.length;d>c;c++)a=e[c],b.append(a.renderHtml());return b},a.prototype.setupHeader=function(){var a,b;return b=this.element.find("thead"),0==b.length&&(b=$("<thead></thead>"),this.element.prepend(b)),b.is("[at-ignore]")||(a=this.constructHeader()),this.element.hasClass("table")||this.element.addClass("table table-bordered table-striped table-responsive table-hover"),b.append(a)},a.prototype.setupFooter=function(){var a=this.element.find("tfoot");if(0==a.length&&(a=$("<tfoot></tfoot>"),this.element.append(a)),a.append(h),this.tableConfiguration.paginated)if(void 0==this.element.attr("at-scroll"))a.append(i);else{var b=angular.element(j);b.addClass("scrolled-pagination"),a.append(b)}},a.prototype.getSetup=function(){return new c},a.prototype.compile=function(){return this.setupHeader(),this.setupFooter(),this.setup=this.getSetup(),this.setup.compile(this.element)},a.prototype.setupInitialSorting=function(a){var b,c,d,e,f;for(e=this.tableConfiguration.columnConfigurations,f=[],c=0,d=e.length;d>c;c++)if(b=e[c],b.initialSorting){if(!b.attribute)throw"initial-sorting specified without attribute.";f.push(a.descending="desc"===b.initialSorting),a.sort(b.attribute)}else f.push(void 0);return f},a.prototype.post=function(a,b,c,d,e,f){a.getSortIcon||(a.getSortIcon=function(b){var c;return a.atConfig.sortList&&a.atConfig.sortList.length>0&&(c=_.find(a.atConfig.sortList,function(a){return a.predicate==b})),c?c.descending?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up":"glyphicon glyphicon-minus"});var g=this.setup.link(a,b,c,d,e,f);return this.setupInitialSorting(a),g},a}(),b=function(){function a(a,b,c,d){if(this.lowerBound=null!=a?a:0,this.upperBound=null!=b?b:1,null==c&&(c=0),this.length=null!=d?d:1,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";this.data=this.generate(c)}return a.prototype.generate=function(a){var b,c,d,e;for(a>this.upperBound-this.length?a=this.upperBound-this.length:a<this.lowerBound&&(a=this.lowerBound),e=[],b=c=a,d=parseInt(a)+parseInt(this.length)-1;d>=a?d>=c:c>=d;b=d>=a?++c:--c)e.push(b);return e},a.prototype.resetParameters=function(a,b,c){if(this.lowerBound=a,this.upperBound=b,this.length=c,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";return this.data=this.generate(this.data[0])},a.prototype.relocate=function(a){var b;return b=this.data[0]+a,this.data=this.generate(b,b+this.length)},a.prototype.realignGreedy=function(a){var b;return a<this.data[0]?(b=a,this.data=this.generate(b)):a>this.data[this.length-1]?(b=a-(this.length-1),this.data=this.generate(b)):void 0},a.prototype.realignGenerous=function(a){},a}(),angular.module("angular-table").directive("atTable",["$filter","$q","$rootScope","$compile",function(a,b,c,d){return{restrict:"AC",scope:!0,compile:function(d,e,h){var i,j,k=angular.element(d.find("tbody").find("tr"));return"ng-click"in k[0].attributes?k[0].attributes["ng-click"].value=k[0].attributes["ng-click"].value.concat("; markSelected(item)"):k.attr("ng-click","markSelected(item)"),k.attr("ng-class","{'table-selected-row' : item == atConfig.selectedItem}"),j=new g(d,e),i=new f(d,j),i.compile(),{post:function(d,e,f){if(i.post(d,e,f,a,b,c),d.markSelected=function(a){return this.atConfig.selectedItem!=a?void(this.atConfig.selectedItem=a):void(this.atConfig.selectedItem=void 0)},void 0!=f.atScroll){var g=angular.element('<div class="table-scroll"></div>');e.before(g),g.append(e),e.find(".scrolled-pagination").insertAfter(g).addClass("text-center")}}}}}}]),angular.module("angular-table").directive("atAttribute",[function(){return{restrict:"A",compile:function(a,b,c){var d;if(d=a.attr("at-attribute"),!d)throw"at-attribute specified without value: "+a.html();return 0==a.children().length?b.atFilter?a.append("{{item."+d+" | "+b.atFilter+"}}"):a.append("{{item."+d+"}}"):void 0}}}])}).call(this);
//# sourceMappingURL=angular-table-restful.min.map